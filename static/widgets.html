
<script>
    Vue.component('smart-seg-widget', {
        props: ['data', 'post'],
        template: `
          <div>

          <el-switch
              v-model="data.isActive"
              on-text=""
              off-text="">
          </el-switch>

          <smarttool-editor
              style="width: 400px; height: 400px;"
              :mask="data.mask"
              :image-url="data.imageUrl"
              :bbox.sync="data.bbox"
              @update:bbox="data.bbox = $event; update_annotation()"
              :positive-points="data.positivePoints"
              @update:positive-points="data.positivePoints = $event; update_annotation()"
              :negative-points="data.negativePoints"
              @update:negative-points="data.negativePoints = $event; update_annotation()"
          ></smarttool-editor>
          </div>

        `,
        methods: {
            async update_annotation() {
                await this.post('/update_annotation', {
                        'id': 123
                    }
                )
            }
        }
    })


    Vue.component('json-viewer', {
        props: ['value'],
        template: `
          <div>
          <div ref="jsoneditor" style="width: 340px; height: 350px;"></div>
          </div>
        `,
        watch: {
            value: {
                handler(value) {
                    console.log('second log', this.value);
                    this.editor.set(value);
                },
                // slow implementation
                deep: true,
            },
        },
        mounted() {
            const container = this.$refs.jsoneditor;
            const options = {
                mode: 'view'
            };
            console.log('first log', this.value);
            this.editor = new JSONEditor(container, options);
            this.editor.set(this.value);

        }

    })
    ;
</script>
